<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Design Pattern · HazardAhead.ai</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="HazardAhead.ai logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">HazardAhead.ai</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../define/">Define Problem</a></li><li class="is-active"><a class="tocitem" href>Design Pattern</a><ul class="internal"><li><a class="tocitem" href="#Pattern"><span>Pattern</span></a></li><li><a class="tocitem" href="#Create-Graph,-Vertices-and-Edges"><span>Create Graph, Vertices and Edges</span></a></li><li><a class="tocitem" href="#Gathering-Visitor,-Food-Supply-and-other-data"><span>Gathering Visitor, Food Supply and other data</span></a></li><li><a class="tocitem" href="#IOTs-climate-data"><span>IOTs climate data</span></a></li><li><a class="tocitem" href="#Analyzing-patterns"><span>Analyzing patterns</span></a></li></ul></li><li><a class="tocitem" href="../iot/">IOTs</a></li><li><a class="tocitem" href="../process/">Data Points</a></li><li><a class="tocitem" href="../usecase/">Use Cases</a></li><li><a class="tocitem" href="../ml/">AI/ML Predictions</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Design Pattern</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Design Pattern</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/AmitXShukla/HazardAhead.ai/blob/master/docs/src/pattern.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Design-Pattern"><a class="docs-heading-anchor" href="#Design-Pattern">Design Pattern</a><a id="Design-Pattern-1"></a><a class="docs-heading-anchor-permalink" href="#Design-Pattern" title="Permalink"></a></h1><p>Now since we know, what objective of this project is, let&#39;s analyze what we already know.</p><p>We will first learn few design patterns, using examples from Theme parks like Disney, Universal or Magic mountain ride parks, who manage crowd gathering so well.</p><p>for example, take a section of map from Disney or universal theme parks.</p><p><em>Disney Themepark</em> <img src="https://github.com/AmitXShukla/HazardAhead.ai/blob/main/assets/images/disney.png?raw=true" alt="Disney Themepark"/></p><p><em>Universal Studio Themepark</em> <img src="https://github.com/AmitXShukla/HazardAhead.ai/blob/main/assets/images/universal.png?raw=true" alt="Universal Studio"/></p><hr/><h2 id="Pattern"><a class="docs-heading-anchor" href="#Pattern">Pattern</a><a id="Pattern-1"></a><a class="docs-heading-anchor-permalink" href="#Pattern" title="Permalink"></a></h2><p>Let&#39;s first analyze few basic characteristics of theme parks.</p><p>To start with, assume all of these theme parks tickets are sold in advance or bought on same day and most of the times, tickets are sold less than maximum occupancy as per capacity allowed.</p><p><em>remember, crowd gathering less than maximum allowed occupancy, may not be the case in  other type of crowd gatherings, such as protests, political rally or festive gatherings etc.. We will address this later in vision IOT section, where it become an important factor to detect anomaly.</em></p><ul><li><p>Create Graph, Vertices and Edges (relationships)</p><p>Let&#39;s break each ride in park by it entity and characteristics (i.e. attributes).</p></li><li><p>Gathering Visitor, Food Supply and other data</p><p>create and load visitor information register and other data</p></li><li><p>IOTs climate data</p><p>gather IOT (Internet of things) data from sensors</p></li><li><p>Analyzing patterns</p></li></ul><hr/><h2 id="Create-Graph,-Vertices-and-Edges"><a class="docs-heading-anchor" href="#Create-Graph,-Vertices-and-Edges">Create Graph, Vertices and Edges</a><a id="Create-Graph,-Vertices-and-Edges-1"></a><a class="docs-heading-anchor-permalink" href="#Create-Graph,-Vertices-and-Edges" title="Permalink"></a></h2><pre><code class="language-julia hljs"># we are using Julia Language for Graph analysis
# TigerGraph provide RESTAPI end points, GSQL and GRAPHSTUDIO to connect TIGERGRAPH
#######################################################################
# pyTigerGraph is a Python based library to connect with GRAPH database and run GSQLs
# we will use Julia PyCall package to connect with pyTigerGraph library
#######################################################################
## **perhaps, some day I will re-write pyTigerGraph package in Julia ##
#######################################################################

# open Julia REPL, Jupyter or your favorite Julia IDE, run following

# first import all packages required to support our data analysis
# rest of this chapter assume that below packages are imported once
import Pkg
Pkg.add(&quot;DataFrames&quot;)
Pkg.add(&quot;CSV&quot;)
Pkg.add(&quot;PyCall&quot;)
Pkg.build(&quot;PyCall&quot;);

# you will also need to install pyTigerGraph in your python environment
# !pip install -U pyTigerGraph</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">    Updating registry at `~/.julia/registries/General`
    Updating git-repo `https://github.com/JuliaRegistries/General.git`
   Resolving package versions...
  No Changes to `~/.julia/environments/v1.7/Project.toml`
  No Changes to `~/.julia/environments/v1.7/Manifest.toml`
   Resolving package versions...
  No Changes to `~/.julia/environments/v1.7/Project.toml`
  No Changes to `~/.julia/environments/v1.7/Manifest.toml`
   Resolving package versions...
  No Changes to `~/.julia/environments/v1.7/Project.toml`
  No Changes to `~/.julia/environments/v1.7/Manifest.toml`
    Building Conda ─→ `~/.julia/scratchspaces/44cfe95a-1eb2-52ea-b672-e2afdf69b78f/6e47d11ea2776bc5627421d59cdcc1296c058071/build.log`
    Building PyCall → `~/.julia/scratchspaces/44cfe95a-1eb2-52ea-b672-e2afdf69b78f/1fc929f47d7c151c839c5fc1375929766fb8edcc/build.log`</code></pre><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>before proceeding any further, please setup Tiger Graph Server instance at <a href="https://tgcloud.io">tgcloud.io</a> please don&#39;t expect these credentials to work for you, as there is cost involved to keep this.</p><p>hostName = &quot;https://p2p.i.tgcloud.io&quot;</p><p>userName = &quot;tigercloud&quot;</p><p>password = &quot;tigercloud&quot;</p><p>graphName = &quot;HazardAhead&quot;</p><p>conn = tg.TigerGraphConnection(host=hostName, username=userName, password=password, graphname=graphName)</p></div></div><hr/><p><em>now once you have TigerGraph and Julia environments setup, let&#39;s jump on to setup sample graph, vertices and edges to get a hang of tools.</em></p><pre><code class="language-julia hljs">import Pkg
# you may not need to add conda, pytigergraph
# if you already have python setup
# these instructions are specific for julia setup
Pkg.add(&quot;Conda&quot;)
ENV[&quot;PYTHON&quot;] = &quot;/usr/bin/python3&quot;
using PyCall
using Conda
Conda.pip_interop(true;)
# Conda.pip_interop(true; [env::Environment=&quot;/usr/bin/python3&quot;])
Conda.pip(&quot;install&quot;, &quot;pyTigerGraph&quot;)
Conda.add(&quot;pyTigerGraph&quot;)
tg = pyimport(&quot;pyTigerGraph&quot;)
# please don&#39;t expect below credentials to work for you, and signup at tgcloud
hostName = &quot;https://p2p.i.tgcloud.io&quot;
userName = &quot;amit&quot;
password = &quot;password&quot;
graphName = &quot;HazardAhead&quot;
conn = tg.TigerGraphConnection(host=hostName, username=userName, password=password, graphname=graphName)
# conn.gsql(getSchema)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PyObject &lt;pyTigerGraph.pyTigerGraph.TigerGraphConnection object at 0x7fa7de2ba6d0&gt;</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Operations that DO NOT need a Token</p><p>Viewing the schema of your graph using functions such as getSchema and getVertexTypes does not require you to have an authentication token. A token is also not required to run gsql commands through pyTigerGraph.</p><p>Sample Connection</p><p>conn = tg.TigerGraphConnection(host=&#39;https://pytigergraph-demo.i.tgcloud.io&#39;, username=&#39;tigergraph&#39; password=&#39;password&#39; graphname=&#39;DemoGraph&#39;)</p><p>Operations that DO need a Token</p><p>A token is required to view or modify any actual DATA in the graph. Examples are: upserting data, deleting edges, and getting stats about any loaded vertices. A token is also required to get version data about the TigerGraph instance.</p><p>Sample Connection</p><p>conn = tg.TigerGraphConnection(host=&#39;https://pytigergraph-demo.i.tgcloud.io&#39;, username=&#39;tigergraph&#39; password=&#39;password&#39; graphname=&#39;DemoGraph&#39;, apiToken=&#39;av1im8nd2v06clbnb424jj7fp09hp049&#39;)</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Below code is directly executed over Python environment</p><p>first you will also need to install pyTigerGraph in your python environment,</p><p>!pip install -U pyTigerGraph</p><p>then execute following commands to create TGCloud Graph</p></div></div><pre><code class="language- hljs">import pyTigerGraph as tg
hostName = &quot;https://p2p.i.tgcloud.io&quot;
userName = &quot;amit&quot;
password = &quot;password&quot;
graphName = &quot;HazardAhead&quot;
conn = tg.TigerGraphConnection(host=hostName, username=userName, password=password, graphname=graphName)

conn.gsql(&quot;ls&quot;)
conn.gsql(&#39;&#39;&#39;USE GLOBAL
DROP ALL
&#39;&#39;&#39;)

conn.gsql(&#39;&#39;&#39;
  USE GLOBAL
  CREATE VERTEX Visitor (PRIMARY_ID id INT, bookDate DATETIME, name STRING, phoneNo INT, age INT, gender STRING, checkIn DATETIME, checkOut DATETIME, specialNeeds BOOL, race STRING, price STRING, accompanies INT, family BOOL, localResident BOOL, ADDRESS STRING) WITH primary_id_as_attribute=&quot;true&quot;

  CREATE VERTEX Ride (PRIMARY_ID id INT, name STRING, indoor BOOL, inlets INT, outlets INT, temperature INT, avgWaitTime INT, popularityRating INT, rideType STRING, rideClass STRING, maturityRating STRING, numExits INT, area INT, numEmployees INT) WITH primary_id_as_attribute=&quot;true&quot;

  CREATE VERTEX FoodCourt (PRIMARY_ID id INT, name STRING, indoor BOOL, inlets INT, outlets INT, temperature INT, avgWaitTime INT, popularityRating INT, foodType STRING, numExits INT, area INT, numEmployees INT) WITH primary_id_as_attribute=&quot;true&quot;

  CREATE DIRECTED EDGE rides (From Visitor, To Ride, rideTime DATETIME)
  CREATE DIRECTED EDGE eats (From Visitor, To FoodCourt, eatTime DATETIME)
  CREATE UNDIRECTED EDGE accompanied (From Visitor, To Visitor)

&#39;&#39;&#39;)
results = conn.gsql(&#39;CREATE GRAPH HazardAhead(Visitor, Ride, FoodCourt, rides, eats, accompanied)&#39;)</code></pre><p><img src="https://github.com/AmitXShukla/HazardAhead.ai/blob/main/docs/assets/images/graph1.png?raw=true" alt="Graph 1"/></p><h4 id="Loading-Data"><a class="docs-heading-anchor" href="#Loading-Data">Loading Data</a><a id="Loading-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-Data" title="Permalink"></a></h4><pre><code class="language-example hljs">conn.gsql(&#39;&#39;&#39;
USE GLOBAL
USE GRAPH HazardAhead
CREATE LOADING JOB HazardAhead_PATH FOR GRAPH HazardAhead {
DEFINE FILENAME file1 = &quot;sampleData/visitor.csv&quot;;
DEFINE FILENAME file2 = &quot;sampleData/ride.csv&quot;;
DEFINE FILENAME file3 = &quot;sampleData/foodcourt.csv&quot;;
DEFINE FILENAME file4 = &quot;sampleData/rides.csv&quot;;
DEFINE FILENAME file5 = &quot;sampleData/eats.csv&quot;;
DEFINE FILENAME file6 = &quot;sampleData/accompanied.csv&quot;;
LOAD file1 TO VERTEX Visitor VALUES ($0, $1,,....) USING header=&quot;true&quot;, separator=&quot;,&quot;;
LOAD file1 TO VERTEX Ride VALUES ($0, $1,,....) USING header=&quot;true&quot;, separator=&quot;,&quot;;
LOAD file1 TO VERTEX FoodCourt VALUES ($0, $1,,....) USING header=&quot;true&quot;, separator=&quot;,&quot;;
LOAD file1 TO VERTEX rides VALUES ($0, $1,,....) USING header=&quot;true&quot;, separator=&quot;,&quot;;
LOAD file1 TO VERTEX eats VALUES ($0, $1,,....) USING header=&quot;true&quot;, separator=&quot;,&quot;;
LOAD file1 TO VERTEX Galaxy accompanied ($0, $1,,....) USING header=&quot;true&quot;, separator=&quot;,&quot;;
}
&#39;&#39;&#39;)

results = conn.gsql(&#39;RUN LOADING JOB HazardAhead_PATH USING file1=&quot;sampleData/visitor.csv&quot;, &quot;sampleData/ride.csv&quot;, ...)</code></pre><p><img src="https://github.com/AmitXShukla/P2P.ai/blob/main/docs/assets/images/graph2.png?raw=true" alt="Graph 2"/></p><p><img src="https://github.com/AmitXShukla/P2P.ai/blob/main/docs/assets/images/graph3.png?raw=true" alt="Graph 3"/></p><p><img src="https://github.com/AmitXShukla/P2P.ai/blob/main/docs/assets/images/graph4.png?raw=true" alt="Graph 4"/></p><hr/><h2 id="Gathering-Visitor,-Food-Supply-and-other-data"><a class="docs-heading-anchor" href="#Gathering-Visitor,-Food-Supply-and-other-data">Gathering Visitor, Food Supply and other data</a><a id="Gathering-Visitor,-Food-Supply-and-other-data-1"></a><a class="docs-heading-anchor-permalink" href="#Gathering-Visitor,-Food-Supply-and-other-data" title="Permalink"></a></h2><hr/><h2 id="IOTs-climate-data"><a class="docs-heading-anchor" href="#IOTs-climate-data">IOTs climate data</a><a id="IOTs-climate-data-1"></a><a class="docs-heading-anchor-permalink" href="#IOTs-climate-data" title="Permalink"></a></h2><hr/><h2 id="Analyzing-patterns"><a class="docs-heading-anchor" href="#Analyzing-patterns">Analyzing patterns</a><a id="Analyzing-patterns-1"></a><a class="docs-heading-anchor-permalink" href="#Analyzing-patterns" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../define/">« Define Problem</a><a class="docs-footer-nextpage" href="../iot/">IOTs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Monday 18 April 2022 23:18">Monday 18 April 2022</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
